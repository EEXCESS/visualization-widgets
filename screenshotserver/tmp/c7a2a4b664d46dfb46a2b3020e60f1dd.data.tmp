{"url":"http:\/\/localhost:8000\/examples\/index-dashboard.html","content":"<head>\n        <title>Search Interface and Resultlist Example<\/title>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"jquery\" src=\"bower_components\/jquery\/dist\/jquery.js\"><\/script><script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"c4\/APIconnector\" src=\"bower_components\/c4\/APIconnector.js\"><\/script><script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"c4\/iframes\" src=\"bower_components\/c4\/iframes.js\"><\/script><script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"peas\/peas_indist\" src=\"bower_components\/peas\/peas_indist.js\"><\/script><script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"peas\/util\" src=\"bower_components\/peas\/util.js\"><\/script><script type=\"text\/javascript\" charset=\"utf-8\" async=\"\" data-requirecontext=\"_\" data-requiremodule=\"graph\" src=\"bower_components\/graph\/lib\/graph.js\"><\/script><\/head>\n    \n    <body>\n        \n        <form id=\"test\">\n            <input id=\"query\" size=\"20\">\n            <input id=\"submit\" type=\"submit\" value=\"Search\">\n        <\/form>\n        \n        <!-- Include the desired widgets as iframes. For this example page, we include all available visualizations -->\n        <iframe src=\"..\/Dashboard\/index.html\" style=\"position: relative; width: 1820px; height: 500px;\" id=\"dashboard\"><\/iframe>\n        <div id=\"screenshot-container\" style=\"display:none;\">\n            <h3>Screenshot:<\/h3>\n            <img id=\"screenshot\">\n        <\/div>\n        <script src=\"bower_components\/requirejs\/require.js\"><\/script>\n        <script src=\"..\/Dashboard\/localStorageAdapter.js\"><\/script>\n        <script src=\"..\/Dashboard\/js\/viseval-demodata.js\"><\/script>\n        \n        <script>\n            var userID = localStorageCustom.getItem('userID');\n            if (!userID){\n                userID = 'SID' + Math.floor(Math.random() * 10000000000);\n                localStorageCustom.setItem('userID', userID);\n                console.log('New SID generated...');\n            }\n            \n            requirejs.config({\n                \/\/urlArgs: \"bust=\" + (new Date()).getTime(),\n                waitSeconds: 0,\n                baseUrl: \"bower_components\",\n                paths: {\n                    jquery: \"jquery\/dist\/jquery\",\n                    requirejs: \"requirejs\/require\",\n                    jqueryui: \"jquery-ui\/jquery-ui\",\n                    \"jquery-ui\": \"jquery-ui\/jquery-ui\",\n                    graph: \"graph\/lib\/graph\",\n                    \"tag-it\": \"tag-it\/js\/tag-it\",\n                    peas_indist: \"peas\/peas_indist\",\n                    peas_adapt: \"peas\/peas_adapt\",\n                    d3:\"d3\/d3\"\n                }\n            });\n            require(['jquery', 'c4\/APIconnector', 'c4\/iframes'], function ($, api, iframes) {\n                \n                var origin =  { clientType: 'Dashboard Standalone Example', clientVersion: '1', userID: userID };\n                api.init({origin: origin});\n                \n\t\t\t\t$('#dashboard').css('width', $(this).width()-20);\n                $(window).on('resize', function(e){ \n                    $('#dashboard').css('width', $(this).width()-20);\n                });\n            \n                \/\/ demo: receive when user clicks on the optional \"linkImageButton\"\n                window.onmessage = function(e) {\n                    var message = e.data;\n                    if (message.event) {\n                        if (message.event === 'eexcess.linkImageClicked' || message.event === 'eexcess.linkItemClicked') {\n                            alert(message.data.id);\n                        }\n                        else if (message.event === 'eexcess.screenshot') {\n                            $('#screenshot-container').show();\n                            $('#screenshot').attr('src', message.data);\n                        }\n                        \/\/ else if (message.event === 'eexcess.tooSmall') {\n                        \/\/     alert('toosmall');\n                        \/\/ }\n                                                \n                        if (message.event.startsWith('eexcess.log')) {\n                            api.logMsgHandler(message);\n                        }\n                    }\n                }\n                \n                \/\/ Load Demo Data, right after the Dashboard-IFRAME has finished loading \n                $('#dashboard').on('load', function(){\n                    \n                    \/\/ send Settings to Dashboard:\n                    iframes.sendMsgAll({event: 'eexcess.newDashboardSettings', settings: {\n                            selectedChart: 'geochart', \n                            hideControlPanel: false, \n                            hideCollections: false,\n                            showLinkImageButton: true,\n                            showLinkItemButton: true,\n                            showScreenshotButton: true,\n                            origin: origin\n                        }});\n                        \n                        \n                    iframes.sendMsgAll({event: 'eexcess.newResults', data: { \n                            result: demoDataHistoricalBuildings, \n                            queryID: \"123HistoricalBuilding\",\n                            profile: { contextKeywords: [{ text: \"Historical Buildings\", weight: 1.0 }], origin: { module: 'demo data' } }\n                        }});\n                });\n                \n                \/\/ handle form search\n                $('#test').submit(function (e) {\n                    e.preventDefault();\n                    \n                    \/\/ Split up query into Keywords\n                    var queryWords = $('#query').val().split(\" \");\n                    var keywords = [];\n                    for (var i=0; i< queryWords.length; i++) {\n                        keywords.push({\n                            text: queryWords[i],\n                            weight: 1.0\n                        });\n                    }\n                    \n                    \/\/ Construct an EEXCESS profile in the format described at https:\/\/github.com\/EEXCESS\/eexcess\/wiki\n                    var originForSearch = { module: 'example search input' };\n                    $.extend(originForSearch, origin);\n                    var profile = { contextKeywords: keywords, origin: originForSearch  \/*, partnerList:[ { \"systemId\":\"ZBW\" } ] *\/ };\n                    iframes.sendMsgAll({event: 'eexcess.queryTriggered', data: profile});\n                    api.setNumResults(100);\n                    api.query(profile, function (res) {\n                        if (res.status === 'success') {\n                            iframes.sendMsgAll({event: 'eexcess.newResults', data: {profile: profile, result: res.data.result, queryID:res.data.queryID }});\n                        } else {\n                            iframes.sendMsgAll({event:'eexcess.error', data: res.data});\n                        }\n                    });\n                });\n                \n            });\n        <\/script>\n    \n\n<\/body>"}