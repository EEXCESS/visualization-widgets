<?php
header("Cache-Control: no-cache, no-store, must-revalidate"); 
header("Pragma: no-cache");
header("Expires: 0");

require_once("ScreenshotVis.php");

$ssVis = new ScreenshotVis();
$errors = [];
$imageLists = [];
try
{
    $ssVis->init();
    $imageLists = $ssVis->getImageLists();
} catch (EvalException $ex)
{
    $errors = $ssVis->getErrors();
}
?>

<html>

    <head>
        <link rel="stylesheet" href="eval.css">
        <script   src="https://code.jquery.com/jquery-2.2.3.min.js"   integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="   crossorigin="anonymous"></script>
        <script>
            $(document).on('ready', function(){
                $('body.filtersOnly .imagelistimage img[src$="-filter.JPEG"]').each(function(){
                    $(this).closest('.imagelistimage').addClass('filter');
                });
                $('body.finalviewOnly .imagelistimage img[src$="finalview.JPEG"]').each(function(){
                    $(this).closest('.imagelistimage').addClass('finalview');
                });
                $('body .imagelistimage img[src*="Main-"]').each(function(){
                    $(this).closest('.imagelistimage').addClass('main');
                });
                $('body .imagelist').each(function(){
                    var $time = $(this).find('[src$="Main-Time-filter.JPEG"]');
                    if ($time.length > 0)
                        $(this).prepend($time.closest('.imagelistimage'));
                    var $bar = $(this).find('[src$="Main-Category-filter.JPEG"]');
                    if ($bar.length > 0)
                        $(this).append($bar.closest('.imagelistimage'));
                });
            });
        </script>
    </head>


    <body class="<?php echo $_GET['css']; ?>">

        <div id="errorlist">
            <?php foreach ($errors as $error) : ?>
                <div class="errormsg"><?php echo $error ?></div>
            <?php endforeach; ?>
        </div>


        <?php
        $cols = "two";
        if (sizeof($imageLists) === 3)
            $cols = "three";
        ?>
        <?php foreach ($imageLists as $userKey => $imageList) : ?>
            <div id="imagelist_<?php echo $userKey ?>" class="imagelist <?php echo $cols; ?>">


                <?php foreach ($imageList as $imageKey => $image) : ?>
                    <div id="imagelist_<?php echo $userKey ?>-image_<?php echo $imageKey ?>" class="imagelistimage">
                        <p><img class="screenshotimg" src="<?php echo $image; ?>" /></p>
                    </div>

                <?php endforeach; ?>

            </div>
        <?php endforeach; ?>




    </body>

</html>
